L=30 #nombres de lignes (rats)
C=5 #nombres de colonnes (jours)
y <-structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C),.Names=c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
x <- c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar <-22.0
View(y)
C
C=5 #nombres de colonnes (jours)
y <-structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C),names=c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
x <- c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar <-22.0
View(y)
L=30 #nombres de lignes (rats)
C=5 #nombres de colonnes (jours)
y <-structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), .Names=c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
x <- c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar <-22.0
View(y)
View(y)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), col.Names = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
View(y)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), .Dimnames = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), .Names = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
View(y)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), .Names = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"), class = "data.frame")
View(y)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), .Names = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
View(y)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), .Jours = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
View(y)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C), names() = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36"))
names(y) = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36")
View(y)
names(y)
dimnames(y)
colnames(y)
colnames(y) = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36")
View(y)
L = 30 #nombres de lignes (rats)
C = 5 #nombres de colonnes (jours)
y <- structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324), .Dim = c(L,
C))
colnames(y) = c("Jour 8","Jour 15","Jour 22","Jour 29","Jour 36")
x <- c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar <-22.0
View(y)
dim(y)
data[,1]
data[1]
class(data)
View(y)
as.data.frame(data)
?structure
y[,1]
?dnorm
x = c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar = 22.0
# État initial
alpha.c = dnorm(0.0, 1.0E-6)
beta.c = dnorm(0.0, 1.0E-6)
alpha.sigma = 1/dgamma(0.001, 0.001)
beta.sigma = 1/dgamma(0.001, 0.001)
sigma.c = 1/dgamma(0.001, 0.001)
alpha0 = alpha.c - xbar * beta.c
alpha = rep(1:nj)
beta = rep(1:nj)
Y = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
mu = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
for (j in 1:nj){
alpha[j] = dnorm(alpha.c, sqrt(alpha.sigma))
beta[j] = dnorm(beta.c, sqrt(beta.sigma))
for (i in 1:ni){
mu[i,j] = alpha[i] + beta[i] * (x[j] - xbar)
Y[i,j] = dnorm(mu[i,j], sqrt(sigma.c))
}
}
# Data
ni = 30 # nombres de lignes (rats)
nj = 5 # nombres de colonnes (jours)
y = structure(c(151, 145, 147, 155, 135, 159, 141, 159, 177, 134,
160, 143, 154, 171, 163, 160, 142, 156, 157, 152, 154, 139, 146,
157, 132, 160, 169, 157, 137, 153, 199, 199, 214, 200, 188, 210,
189, 201, 236, 182, 208, 188, 200, 221, 216, 207, 187, 203, 212,
203, 205, 190, 191, 211, 185, 207, 216, 205, 180, 200, 246, 249,
263, 237, 230, 252, 231, 248, 285, 220, 261, 220, 244, 270, 242,
248, 234, 243, 259, 246, 253, 225, 229, 250, 237, 257, 261, 248,
219, 244, 283, 293, 312, 272, 280, 298, 275, 297, 350, 260, 313,
273, 289, 326, 281, 288, 280, 283, 307, 286, 298, 267, 272, 285,
286, 303, 295, 289, 258, 286, 320, 354, 328, 297, 323, 331, 305,
338, 376, 296, 352, 314, 325, 358, 312, 324, 316, 317, 336, 321,
334, 302, 302, 323, 331, 345, 333, 316, 291, 324),
.Dim = c(L, C))
colnames(y) = c("Jour 8", "Jour 15", "Jour 22", "Jour 29", "Jour 36")
x = c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar = 22.0
x = c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar = 22.0
# État initial
alpha.c = dnorm(0.0, 1.0E-6)
beta.c = dnorm(0.0, 1.0E-6)
alpha.sigma = 1/dgamma(0.001, 0.001)
beta.sigma = 1/dgamma(0.001, 0.001)
sigma.c = 1/dgamma(0.001, 0.001)
alpha0 = alpha.c - xbar * beta.c
alpha = rep(1:nj)
beta = rep(1:nj)
Y = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
mu = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
for (j in 1:nj){
alpha[j] = dnorm(alpha.c, sqrt(alpha.sigma))
beta[j] = dnorm(beta.c, sqrt(beta.sigma))
for (i in 1:ni){
mu[i,j] = alpha[i] + beta[i] * (x[j] - xbar)
Y[i,j] = dnorm(mu[i,j], sqrt(sigma.c))
}
}
x = c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar = 22.0
# État initial
alpha.c = rnorm(0.0, 1.0E-6)
beta.c = rnorm(0.0, 1.0E-6)
alpha.sigma = 1/rgamma(0.001, 0.001)
beta.sigma = 1/rgamma(0.001, 0.001)
sigma.c = 1/rgamma(0.001, 0.001)
alpha0 = alpha.c - xbar * beta.c
alpha = rep(1:nj)
beta = rep(1:nj)
Y = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
mu = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
for (j in 1:nj){
alpha[j] = rnorm(alpha.c, sqrt(alpha.sigma))
beta[j] = rnorm(beta.c, sqrt(beta.sigma))
for (i in 1:ni){
mu[i,j] = alpha[i] + beta[i] * (x[j] - xbar)
Y[i,j] = rnorm(mu[i,j], sqrt(sigma.c))
}
}
x = c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar = 22.0
# État initial
alpha.c = dnorm(0.0, 1.0E-6)
beta.c = dnorm(0.0, 1.0E-6)
alpha.sigma = 1/dgamma(0.001, 0.001)
beta.sigma = 1/dgamma(0.001, 0.001)
sigma.c = 1/dgamma(0.001, 0.001)
alpha0 = alpha.c - xbar * beta.c
alpha = rep(1:nj)
beta = rep(1:nj)
Y = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
mu = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
for (j in 1:nj){
alpha[j] = dnorm(alpha.c, sqrt(alpha.sigma))
beta[j] = dnorm(beta.c, sqrt(beta.sigma))
for (i in 1:ni){
mu[i,j] = alpha[i] + beta[i] * (x[j] - xbar)
Y[i,j] = dnorm(mu[i,j], sqrt(sigma.c))
}
}
View(Y)
x = c(8.0, 15.0, 22.0, 29.0, 36.0)
xbar = 22.0
# État initial
alpha.c = dnorm(0.0, 1.0E-6)
beta.c = dnorm(0.0, 1.0E-6)
alpha.sigma = 1/dgamma(0.001, 0.001)
beta.sigma = 1/dgamma(0.001, 0.001)
sigma.c = 1/dgamma(0.001, 0.001)
alpha0 = alpha.c - xbar * beta.c
alpha = rep(1:nj)
beta = rep(1:nj)
Y = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
mu = matrix(1:ni*nj, ncol = nj, nrow = ni, byrow = FALSE)
for (i in 1:ni){
alpha[i] = dnorm(alpha.c, sqrt(alpha.sigma))
beta[i] = dnorm(beta.c, sqrt(beta.sigma))
for (j in 1:nj){
mu[j,i] = alpha[j] + beta[j] * (x[i] - xbar)
Y[j,i] = dnorm(mu[j,i], sqrt(sigma.c))
}
}
View(Y)
View(mu)
View(Y)
dnorm(0.0, 1.0E-6)
dnorm(0.0, 1.0E-6)
dnorm(0.0, 1.0E-6)
View(Y)
plot(dnorm(0,1))
plot(dnorm(0,1,2))
plot(dnorm(0,1.2))
plot(dnorm(1,1.2))
?dnorm
dnorm(0)
dnorm(0,1.2)
dnorm(0,1)
dnorm(0,0)
dnorm(0,0,1)
dnorm(0,0,2)
?rgamma
alpha.c = rnorm(1, 0.0, 1.0E-6)
beta.c = rnorm(1, 0.0, 1.0E-6)
alpha.sigma = 1/rgamma(1, 0.001, 0.001)
beta.sigma = 1/rgamma(1, 0.001, 0.001)
sigma.c = 1/rgamma(1, 0.001, 0.001)
alpha0 = alpha.c - xbar * beta.c
alpha = rnorm(1, alpha.c, sqrt(alpha.sigma))
beta = rnorm(1, beta.c, sqrt(beta.sigma))
rgamma(1, 0.001, 0.001)
rgamma(1, 0.001, 1/0.001)
rnorm(1, 0.0, 1.0E-6)
rnorm(1, 0.0, 1.0E-6)
rnorm(1, 0.0, 1.0E-6)
rnorm(1, 0.0, 1.0E-6)
rgamma(1, 0.001, 1/0.001)
rgamma(1, 0.001, 1/0.001)
rgamma(1, 1, 1)
1/rgamma(1, 1, 1)
alpha.c = rnorm(1, 0, 1)
beta.c = rnorm(1, 0, 1)
alpha.sigma = 1/rgamma(1, 1, 1)
beta.sigma = 1/rgamma(1, 1, 1)
sigma.c = 1/rgamma(1, 1, 1)
alpha0 = alpha.c - xbar * beta.c
alpha = rnorm(1, alpha.c, sqrt(alpha.sigma))
beta = rnorm(1, beta.c, sqrt(beta.sigma))
init = c(alpha.c, beta.c, alpha.sigma, beta.sigma, sigma.c, alpha, beta)
mean(y[,2]-y[,1])
mean(y[,2])/mean(y[,1])
sd(y)
?mahalanobis
?dnorm
alpha = rep(mean(data[,1]), ni)
beta = rep(mean(data[,2])/mean(data[,1]), ni)
init = c(alpha.c, beta.c, alpha.sigma, beta.sigma, sigma.c, alpha, beta)
alpha = rep(mean(y[,1]), ni)
beta = rep(mean(y[,2])/mean(y[,1]), ni)
init = c(alpha.c, beta.c, alpha.sigma, beta.sigma, sigma.c, alpha, beta)
init
